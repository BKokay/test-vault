# Week Goal 
**Thursday**:
- Zalando problem error in FuelSaver Api
**Friday**:
- Continue and push

## Thursday 90 minute sessions
- Review what I have so far; the created class and see how it can be used. Which layer? 
- Refactor the `DaoDeleteUtil` method - each class needs to have it for themselves because the code is very confusing. 
- For each exception thrown, you don't have to re-catch it in each layer. You just have to make sure it is included in your exception handler and return the appropriate HTTP message. Something like: 
```java
  @RestControllerAdvice
public class GlobalExceptionHandler {

    @ExceptionHandler(DeleteNotAllowed.class)
    public ResponseEntity<Problem> handleDeleteNotAllowed(DeleteNotAllowed ex) {
        return ResponseEntity
            .status(HttpStatus.FORBIDDEN)
            .contentType(MediaType.APPLICATION_PROBLEM_JSON)
            .body(ex);  // Since DeleteNotAllowed already extends AbstractThrowableProblem
    }
}
```
The key points are:

- Using `MediaType.APPLICATION_PROBLEM_JSON` as the content type
- Directly returning the exception since it's already a `Problem` (extends `AbstractThrowableProblem`)
- Setting the appropriate HTTP status (403 FORBIDDEN in this case)

Since your `DeleteNotAllowed` class already defines the Problem details (type, title, status, detail), you don't need to create a new Problem instance in the handler - you can just return the exception itself as the response body.

### Notes of things that need to be fixed:
- When the token is expired, a weird HTML message is the return - not a json
- When there is an error on the database or whatever, the controller just catches all exceptions and returns that the HWID on device is wrong. That isn't correct. 